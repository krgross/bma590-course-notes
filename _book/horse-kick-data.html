<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 Horse-kick data | BMA / ST 590 Course Notes</title>
  <meta name="description" content="Course notes for BMA / ST 590, Statistical Modeling in Ecology, NCSU, Fall 2021." />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="2 Horse-kick data | BMA / ST 590 Course Notes" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Course notes for BMA / ST 590, Statistical Modeling in Ecology, NCSU, Fall 2021." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 Horse-kick data | BMA / ST 590 Course Notes" />
  
  <meta name="twitter:description" content="Course notes for BMA / ST 590, Statistical Modeling in Ecology, NCSU, Fall 2021." />
  

<meta name="author" content="Kevin Gross" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introduction-to-likelihood.html"/>
<link rel="next" href="myxomatosis-data.html"/>
<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="introduction-to-likelihood.html"><a href="introduction-to-likelihood.html"><i class="fa fa-check"></i><b>1</b> Introduction to likelihood</a></li>
<li class="chapter" data-level="2" data-path="horse-kick-data.html"><a href="horse-kick-data.html"><i class="fa fa-check"></i><b>2</b> Horse-kick data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="horse-kick-data.html"><a href="horse-kick-data.html#find-the-mle-numerically-using-optimize"><i class="fa fa-check"></i><b>2.1</b> Find the MLE numerically using ‘optimize’</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="myxomatosis-data.html"><a href="myxomatosis-data.html"><i class="fa fa-check"></i><b>3</b> Myxomatosis data</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">BMA / ST 590 Course Notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="horse-kick-data" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Horse-kick data</h1>
<p>First import the data. Note that the pathname used here is specific to the file directory that was used to create this file. The pathname that you use will likely differ.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="horse-kick-data.html#cb2-1" aria-hidden="true" tabindex="-1"></a>horse <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;data/horse.txt&quot;</span>, <span class="at">header =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>Ask for a  of the data to make sure the data have been imported correctly.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="horse-kick-data.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(horse)</span></code></pre></div>
<pre><code>##       year         corps               deaths   
##  Min.   :1875   Length:280         Min.   :0.0  
##  1st Qu.:1880   Class :character   1st Qu.:0.0  
##  Median :1884   Mode  :character   Median :0.0  
##  Mean   :1884                      Mean   :0.7  
##  3rd Qu.:1889                      3rd Qu.:1.0  
##  Max.   :1894                      Max.   :4.0</code></pre>
<p>We can also learn about the data by asking to see the first few records using the  command</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="horse-kick-data.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(horse)</span></code></pre></div>
<pre><code>##   year corps deaths
## 1 1875    GC      0
## 2 1876    GC      2
## 3 1877    GC      2
## 4 1878    GC      1
## 5 1879    GC      0
## 6 1880    GC      0</code></pre>
<p>or we can see the last few records using the  command:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="horse-kick-data.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(horse)</span></code></pre></div>
<pre><code>##     year corps deaths
## 275 1889   C15      2
## 276 1890   C15      2
## 277 1891   C15      0
## 278 1892   C15      0
## 279 1893   C15      0
## 280 1894   C15      0</code></pre>
<p>Let’s plot a histogram of the values:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="horse-kick-data.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(horse<span class="sc">$</span>deaths,</span>
<span id="cb9-2"><a href="horse-kick-data.html#cb9-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">min</span>(horse<span class="sc">$</span>deaths) <span class="sc">-</span> <span class="fl">0.5</span>, </span>
<span id="cb9-3"><a href="horse-kick-data.html#cb9-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">to =</span> <span class="fu">max</span>(horse<span class="sc">$</span>deaths) <span class="sc">+</span> <span class="fl">0.5</span>, </span>
<span id="cb9-4"><a href="horse-kick-data.html#cb9-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">by =</span> <span class="dv">1</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-6-1.png" width="672" />
## Calculate and plot the log-likelihood function</p>
<p>Create a function that calculates the log-likelihood for a value of <span class="math inline">\(\lambda\)</span>:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="horse-kick-data.html#cb10-1" aria-hidden="true" tabindex="-1"></a>horse.ll <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda){</span>
<span id="cb10-2"><a href="horse-kick-data.html#cb10-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-3"><a href="horse-kick-data.html#cb10-3" aria-hidden="true" tabindex="-1"></a>  ll.vals <span class="ot">&lt;-</span> <span class="fu">dpois</span>(<span class="at">x =</span> horse<span class="sc">$</span>deaths, <span class="at">lambda =</span> lambda, <span class="at">log =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-4"><a href="horse-kick-data.html#cb10-4" aria-hidden="true" tabindex="-1"></a>  ll <span class="ot">&lt;-</span> <span class="fu">sum</span>(ll.vals)</span>
<span id="cb10-5"><a href="horse-kick-data.html#cb10-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-6"><a href="horse-kick-data.html#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(ll)</span>
<span id="cb10-7"><a href="horse-kick-data.html#cb10-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>We can use this function to calculate the log-likelihood for any value of <span class="math inline">\(\lambda\)</span>, such as <span class="math inline">\(\lambda = 1\)</span>:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="horse-kick-data.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">horse.ll</span>(<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] -328.2462</code></pre>
<p>Let’s calculate the log-likelihood for many values of <span class="math inline">\(\lambda\)</span>, in preparation for making a plot. We’ll use a loop here, and not worry about vectorization.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="horse-kick-data.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a vector of lambda values using the &#39;seq&#39;uence command</span></span>
<span id="cb13-2"><a href="horse-kick-data.html#cb13-2" aria-hidden="true" tabindex="-1"></a>lambda.vals <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fl">0.1</span>, <span class="at">to =</span> <span class="fl">2.0</span>, <span class="at">by =</span> <span class="fl">0.01</span>)  </span>
<span id="cb13-3"><a href="horse-kick-data.html#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="horse-kick-data.html#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># create an empty vector to store the values of the log-likelihood</span></span>
<span id="cb13-5"><a href="horse-kick-data.html#cb13-5" aria-hidden="true" tabindex="-1"></a>ll.vals <span class="ot">&lt;-</span> <span class="fu">double</span>(<span class="at">length =</span> <span class="fu">length</span>(lambda.vals))  </span>
<span id="cb13-6"><a href="horse-kick-data.html#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="horse-kick-data.html#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co"># use a loop to find the log-likelihood for each value in lambda.vals</span></span>
<span id="cb13-8"><a href="horse-kick-data.html#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i.lambda <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(lambda.vals)) {</span>
<span id="cb13-9"><a href="horse-kick-data.html#cb13-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-10"><a href="horse-kick-data.html#cb13-10" aria-hidden="true" tabindex="-1"></a>  ll.vals[i.lambda] <span class="ot">&lt;-</span> <span class="fu">horse.ll</span>(lambda.vals[i.lambda])</span>
<span id="cb13-11"><a href="horse-kick-data.html#cb13-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Now plot the log-likelihood values vs. the values of <span class="math inline">\(\lambda\)</span>:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="horse-kick-data.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ll.vals <span class="sc">~</span> lambda.vals, <span class="at">xlab =</span> <span class="st">&quot;lambda&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;log likelihood&quot;</span>, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span>
<span id="cb14-2"><a href="horse-kick-data.html#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fl">0.7</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<div id="find-the-mle-numerically-using-optimize" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Find the MLE numerically using ‘optimize’</h2>
<p>Note that Bolker’s book illustrates numerical optimization using the ‘optim’ function. The R documentation recommends using ‘optimize’ for one-dimensional optimization, and ‘optim’ for optimizing a function in several dimensions. So, we will use ‘optimize’ here.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="horse-kick-data.html#cb15-1" aria-hidden="true" tabindex="-1"></a>horse.mle <span class="ot">&lt;-</span> <span class="fu">optimize</span>(<span class="at">f =</span> horse.ll, <span class="at">interval =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">2</span>), <span class="at">maximum =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>The ‘optimize’ function returns a ‘list.’ A list is an R object that contains components of different types. We can see all the components of this list by printing it.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="horse-kick-data.html#cb16-1" aria-hidden="true" tabindex="-1"></a>horse.mle </span></code></pre></div>
<pre><code>## $maximum
## [1] 0.7000088
## 
## $objective
## [1] -314.1545</code></pre>
<p>So the numerically calculated MLE is <span class="math inline">\(\hat{lambda} \approx 0.7\)</span>. The ‘objective’ component of  gives the value of the log-likelihood at that point.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction-to-likelihood.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="myxomatosis-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
