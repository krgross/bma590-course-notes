<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 1 Maximum likelihood estimation | bookdown-demo</title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 1 Maximum likelihood estimation | bookdown-demo" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 1 Maximum likelihood estimation | bookdown-demo" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  

<link rel="next" href="beyond-the-mle-confidence-regions-and-hypothesis-tests-using-the-likelihood-function.html"/>
<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<script src="libs/jquery-3.5.1/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html"><i class="fa fa-check"></i><b>1</b> Maximum likelihood estimation</a>
<ul>
<li class="chapter" data-level="1.1" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html#a-very-simple-example-with-a-single-observation"><i class="fa fa-check"></i><b>1.1</b> A very simple example with a single observation</a></li>
<li class="chapter" data-level="1.2" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html#horse-kick-data"><i class="fa fa-check"></i><b>1.2</b> Horse-kick data</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html#calculate-and-plot-the-log-likelihood-function"><i class="fa fa-check"></i><b>1.2.1</b> Calculate and plot the log-likelihood function</a></li>
<li class="chapter" data-level="1.2.2" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html#find-the-mle-numerically-using-optimize"><i class="fa fa-check"></i><b>1.2.2</b> Find the MLE numerically using ‘optimize’</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html#myxomatosis-data"><i class="fa fa-check"></i><b>1.3</b> Myxomatosis data</a></li>
<li class="chapter" data-level="1.4" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html#tadpole-data"><i class="fa fa-check"></i><b>1.4</b> Tadpole data</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="beyond-the-mle-confidence-regions-and-hypothesis-tests-using-the-likelihood-function.html"><a href="beyond-the-mle-confidence-regions-and-hypothesis-tests-using-the-likelihood-function.html"><i class="fa fa-check"></i><b>2</b> Beyond the MLE: Confidence regions and hypothesis tests using the likelihood function</a>
<ul>
<li class="chapter" data-level="2.1" data-path="beyond-the-mle-confidence-regions-and-hypothesis-tests-using-the-likelihood-function.html"><a href="beyond-the-mle-confidence-regions-and-hypothesis-tests-using-the-likelihood-function.html#confidence-intervals-for-single-parameters"><i class="fa fa-check"></i><b>2.1</b> Confidence intervals for single parameters</a></li>
<li class="chapter" data-level="2.2" data-path="beyond-the-mle-confidence-regions-and-hypothesis-tests-using-the-likelihood-function.html"><a href="beyond-the-mle-confidence-regions-and-hypothesis-tests-using-the-likelihood-function.html#two-param-mle"><i class="fa fa-check"></i><b>2.2</b> Confidence regions, profile likelihoods, and associated univariate intervals</a></li>
<li class="chapter" data-level="2.3" data-path="beyond-the-mle-confidence-regions-and-hypothesis-tests-using-the-likelihood-function.html"><a href="beyond-the-mle-confidence-regions-and-hypothesis-tests-using-the-likelihood-function.html#locally-quadratic-approximations-to-confidence-intervals-and-regions"><i class="fa fa-check"></i><b>2.3</b> Locally quadratic approximations to confidence intervals and regions</a></li>
<li class="chapter" data-level="2.4" data-path="beyond-the-mle-confidence-regions-and-hypothesis-tests-using-the-likelihood-function.html"><a href="beyond-the-mle-confidence-regions-and-hypothesis-tests-using-the-likelihood-function.html#comparing-models-likelihood-ratio-test-and-aic"><i class="fa fa-check"></i><b>2.4</b> Comparing models: Likelihood ratio test and AIC</a></li>
<li class="chapter" data-level="2.5" data-path="beyond-the-mle-confidence-regions-and-hypothesis-tests-using-the-likelihood-function.html"><a href="beyond-the-mle-confidence-regions-and-hypothesis-tests-using-the-likelihood-function.html#transformable-constraints"><i class="fa fa-check"></i><b>2.5</b> Transformable constraints</a></li>
<li class="chapter" data-level="2.6" data-path="beyond-the-mle-confidence-regions-and-hypothesis-tests-using-the-likelihood-function.html"><a href="beyond-the-mle-confidence-regions-and-hypothesis-tests-using-the-likelihood-function.html#the-negative-binomial-distriution-revisited"><i class="fa fa-check"></i><b>2.6</b> The negative binomial distriution, revisited</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="bayesian-computation.html"><a href="bayesian-computation.html"><i class="fa fa-check"></i><b>3</b> Bayesian computation</a>
<ul>
<li class="chapter" data-level="3.1" data-path="bayesian-computation.html"><a href="bayesian-computation.html#computations-with-conjugate-priors"><i class="fa fa-check"></i><b>3.1</b> Computations with conjugate priors</a></li>
<li class="chapter" data-level="3.2" data-path="bayesian-computation.html"><a href="bayesian-computation.html#jags-in-r"><i class="fa fa-check"></i><b>3.2</b> JAGS in R</a></li>
<li class="chapter" data-level="3.3" data-path="bayesian-computation.html"><a href="bayesian-computation.html#rstanarm"><i class="fa fa-check"></i><b>3.3</b> rstanarm</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="smooth-regression.html"><a href="smooth-regression.html"><i class="fa fa-check"></i><b>4</b> Smooth regression</a>
<ul>
<li class="chapter" data-level="4.1" data-path="smooth-regression.html"><a href="smooth-regression.html#loess-smoothers"><i class="fa fa-check"></i><b>4.1</b> Loess smoothers</a></li>
<li class="chapter" data-level="4.2" data-path="smooth-regression.html"><a href="smooth-regression.html#splines"><i class="fa fa-check"></i><b>4.2</b> Splines</a></li>
<li class="chapter" data-level="4.3" data-path="smooth-regression.html"><a href="smooth-regression.html#generalized-additive-models-gams"><i class="fa fa-check"></i><b>4.3</b> Generalized additive models (GAMs)</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="generalized-least-squares.html"><a href="generalized-least-squares.html"><i class="fa fa-check"></i><b>5</b> Generalized Least Squares</a>
<ul>
<li class="chapter" data-level="5.1" data-path="generalized-least-squares.html"><a href="generalized-least-squares.html#heterogeneous-variance"><i class="fa fa-check"></i><b>5.1</b> Heterogeneous variance</a></li>
<li class="chapter" data-level="5.2" data-path="generalized-least-squares.html"><a href="generalized-least-squares.html#temporal-serial-correlation"><i class="fa fa-check"></i><b>5.2</b> Temporal (serial) correlation</a></li>
<li class="chapter" data-level="5.3" data-path="generalized-least-squares.html"><a href="generalized-least-squares.html#spatial-data"><i class="fa fa-check"></i><b>5.3</b> Spatial data</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="hierarchical-models.html"><a href="hierarchical-models.html"><i class="fa fa-check"></i><b>6</b> Hierarchical Models</a>
<ul>
<li class="chapter" data-level="6.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#one-factor-layout-dyestuff-data"><i class="fa fa-check"></i><b>6.1</b> One-factor layout: Dyestuff data</a></li>
<li class="chapter" data-level="6.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#bayesian-analysis"><i class="fa fa-check"></i><b>6.2</b> Bayesian analysis</a></li>
<li class="chapter" data-level="6.3" data-path="hierarchical-models.html"><a href="hierarchical-models.html#negative-within-group-correlations"><i class="fa fa-check"></i><b>6.3</b> Negative within-group correlations</a></li>
<li class="chapter" data-level="6.4" data-path="hierarchical-models.html"><a href="hierarchical-models.html#random-coefficient-models-rikz-data"><i class="fa fa-check"></i><b>6.4</b> Random coefficient models: RIKZ data</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#analysis-without-beach-level-covariate"><i class="fa fa-check"></i><b>6.4.1</b> Analysis without beach-level covariate</a></li>
<li class="chapter" data-level="6.4.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#adding-a-beach-level-covariate"><i class="fa fa-check"></i><b>6.4.2</b> Adding a beach-level covariate</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="hierarchical-models.html"><a href="hierarchical-models.html#nested-and-crossed-random-effects"><i class="fa fa-check"></i><b>6.5</b> Nested and crossed random effects</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#nested-random-effects"><i class="fa fa-check"></i><b>6.5.1</b> Nested random effects</a></li>
<li class="chapter" data-level="6.5.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#crossed-random-effects"><i class="fa fa-check"></i><b>6.5.2</b> Crossed random effects</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html"><i class="fa fa-check"></i><b>7</b> Generalized linear models</a>
<ul>
<li class="chapter" data-level="7.1" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#poisson-regression"><i class="fa fa-check"></i><b>7.1</b> Poisson regression</a></li>
<li class="chapter" data-level="7.2" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#bayesian-interlude"><i class="fa fa-check"></i><b>7.2</b> Bayesian interlude</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#rstanarm-1"><i class="fa fa-check"></i><b>7.2.1</b> rstanarm</a></li>
<li class="chapter" data-level="7.2.2" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#posterior-predictive-checks"><i class="fa fa-check"></i><b>7.2.2</b> Posterior predictive checks</a></li>
<li class="chapter" data-level="7.2.3" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#jags"><i class="fa fa-check"></i><b>7.2.3</b> JAGS</a></li>
<li class="chapter" data-level="7.2.4" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#observation-level-random-effects"><i class="fa fa-check"></i><b>7.2.4</b> Observation-level random effects</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!--bookdown:title:end-->
<!--bookdown:title:start-->
<div id="maximum-likelihood-estimation" class="section level1" number="1">
<h1><span class="header-section-number">Chapter 1</span> Maximum likelihood estimation</h1>
<div id="a-very-simple-example-with-a-single-observation" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> A very simple example with a single observation</h2>
<p>Suppose we observe a single observation from a Poisson distribution. Suppose that observation is <span class="math inline">\(X=2\)</span>. We can use the <code>dpois</code> function to evaluate the likelihood for this single observation. For example, we can evaluate the likelihood at <span class="math inline">\(\lambda = 1.5\)</span>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="maximum-likelihood-estimation.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dpois</span>(<span class="at">x =</span> <span class="dv">2</span>, <span class="at">lambda =</span> <span class="fl">1.5</span>)</span></code></pre></div>
<pre><code>## [1] 0.2510214</code></pre>
<p>Or we could evaluate the likelihood at <span class="math inline">\(\lambda = 2\)</span> or <span class="math inline">\(\lambda = 2.5\)</span>:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="maximum-likelihood-estimation.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dpois</span>(<span class="at">x =</span> <span class="dv">2</span>, <span class="at">lambda =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">2.5</span>))</span></code></pre></div>
<pre><code>## [1] 0.2706706 0.2565156</code></pre>
<p>Now let’s evaluate the likelihood at a sequence of <span class="math inline">\(\lambda\)</span> values:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="maximum-likelihood-estimation.html#cb5-1" aria-hidden="true" tabindex="-1"></a>lambda.vals <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">5</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb5-2"><a href="maximum-likelihood-estimation.html#cb5-2" aria-hidden="true" tabindex="-1"></a>my.lhood <span class="ot">&lt;-</span> <span class="fu">dpois</span>(<span class="at">x =</span> <span class="dv">2</span>, <span class="at">lambda =</span> lambda.vals)</span>
<span id="cb5-3"><a href="maximum-likelihood-estimation.html#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lambda.vals, my.lhood, <span class="at">xlab =</span> <span class="fu">expression</span>(lambda), <span class="at">ylab =</span> <span class="st">&quot;Likelihood&quot;</span>, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="01-LikelihoodIntro_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>We might guess that the likelihood is maximized at <span class="math inline">\(\lambda = 2\)</span>. We’d be right.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="maximum-likelihood-estimation.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lambda.vals, my.lhood, <span class="at">xlab =</span> <span class="fu">expression</span>(lambda), <span class="at">ylab =</span> <span class="st">&quot;Likelihood&quot;</span>, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span>
<span id="cb6-2"><a href="maximum-likelihood-estimation.html#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="01-LikelihoodIntro_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
</div>
<div id="horse-kick-data" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Horse-kick data</h2>
<p>Most real data sets contain more than a single observation. Here is a data set that we can use to illustrate maximum likelihood estimation with a single parameter. Famously, Ladislaus van Bortkewitsch (1868 - 1931) published how many members of the Prussiam army were killed by horse kicks in each of 20 years, for each of 14 army corps. As a caveat, these data are often used to illustrate the Poisson distribution, as we will use them. They match the Poisson distribution more neatly than we might expect for most data sets.</p>
<p>First import the data. Note that the path name used here is specific to the file directory that was used to create this file. The path name that you use will likely differ.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="maximum-likelihood-estimation.html#cb7-1" aria-hidden="true" tabindex="-1"></a>horse <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;data/horse.txt&quot;</span>, <span class="at">header =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>Ask for a <code>summary</code> of the data to make sure the data have been imported correctly.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="maximum-likelihood-estimation.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(horse)</span></code></pre></div>
<pre><code>##       year         corps               deaths   
##  Min.   :1875   Length:280         Min.   :0.0  
##  1st Qu.:1880   Class :character   1st Qu.:0.0  
##  Median :1884   Mode  :character   Median :0.0  
##  Mean   :1884                      Mean   :0.7  
##  3rd Qu.:1889                      3rd Qu.:1.0  
##  Max.   :1894                      Max.   :4.0</code></pre>
<p>We can also learn about the data by asking to see the first few records using the <code>head</code> command</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="maximum-likelihood-estimation.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(horse)</span></code></pre></div>
<pre><code>##   year corps deaths
## 1 1875    GC      0
## 2 1876    GC      2
## 3 1877    GC      2
## 4 1878    GC      1
## 5 1879    GC      0
## 6 1880    GC      0</code></pre>
<p>or we can see the last few records using the <code>tail</code> command:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="maximum-likelihood-estimation.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(horse)</span></code></pre></div>
<pre><code>##     year corps deaths
## 275 1889   C15      2
## 276 1890   C15      2
## 277 1891   C15      0
## 278 1892   C15      0
## 279 1893   C15      0
## 280 1894   C15      0</code></pre>
<p>Another useful function to keep in mind is the `str’ function which tells you about the [str]ucture of an R object:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="maximum-likelihood-estimation.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(horse)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    280 obs. of  3 variables:
##  $ year  : int  1875 1876 1877 1878 1879 1880 1881 1882 1883 1884 ...
##  $ corps : chr  &quot;GC&quot; &quot;GC&quot; &quot;GC&quot; &quot;GC&quot; ...
##  $ deaths: int  0 2 2 1 0 0 1 1 0 3 ...</code></pre>
<p>Let’s plot a histogram of the values:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="maximum-likelihood-estimation.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(horse<span class="sc">$</span>deaths,</span>
<span id="cb16-2"><a href="maximum-likelihood-estimation.html#cb16-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">min</span>(horse<span class="sc">$</span>deaths) <span class="sc">-</span> <span class="fl">0.5</span>, </span>
<span id="cb16-3"><a href="maximum-likelihood-estimation.html#cb16-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">to =</span> <span class="fu">max</span>(horse<span class="sc">$</span>deaths) <span class="sc">+</span> <span class="fl">0.5</span>, </span>
<span id="cb16-4"><a href="maximum-likelihood-estimation.html#cb16-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">by =</span> <span class="dv">1</span>))</span></code></pre></div>
<p><img src="01-LikelihoodIntro_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<div id="calculate-and-plot-the-log-likelihood-function" class="section level3" number="1.2.1">
<h3><span class="header-section-number">1.2.1</span> Calculate and plot the log-likelihood function</h3>
<p>Create a function that calculates the log-likelihood for a value of <span class="math inline">\(\lambda\)</span>:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="maximum-likelihood-estimation.html#cb17-1" aria-hidden="true" tabindex="-1"></a>horse.ll <span class="ot">&lt;-</span> <span class="cf">function</span>(my.lambda){</span>
<span id="cb17-2"><a href="maximum-likelihood-estimation.html#cb17-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-3"><a href="maximum-likelihood-estimation.html#cb17-3" aria-hidden="true" tabindex="-1"></a>  ll.vals <span class="ot">&lt;-</span> <span class="fu">dpois</span>(<span class="at">x =</span> horse<span class="sc">$</span>deaths, <span class="at">lambda =</span> my.lambda, <span class="at">log =</span> <span class="cn">TRUE</span>)</span>
<span id="cb17-4"><a href="maximum-likelihood-estimation.html#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(ll.vals)</span>
<span id="cb17-5"><a href="maximum-likelihood-estimation.html#cb17-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>We can use this function to calculate the log-likelihood for any value of <span class="math inline">\(\lambda\)</span>, such as <span class="math inline">\(\lambda = 1\)</span>:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="maximum-likelihood-estimation.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">horse.ll</span>(<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] -328.2462</code></pre>
<p>Let’s calculate the log-likelihood for many values of <span class="math inline">\(\lambda\)</span>, in preparation for making a plot. We’ll use a loop here, and not worry about vectorization.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="maximum-likelihood-estimation.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a vector of lambda values using the &#39;seq&#39;uence command</span></span>
<span id="cb20-2"><a href="maximum-likelihood-estimation.html#cb20-2" aria-hidden="true" tabindex="-1"></a>lambda.vals <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fl">0.01</span>, <span class="at">to =</span> <span class="fl">2.0</span>, <span class="at">by =</span> <span class="fl">0.01</span>)  </span>
<span id="cb20-3"><a href="maximum-likelihood-estimation.html#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="maximum-likelihood-estimation.html#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co"># create an empty vector to store the values of the log-likelihood</span></span>
<span id="cb20-5"><a href="maximum-likelihood-estimation.html#cb20-5" aria-hidden="true" tabindex="-1"></a>ll.vals <span class="ot">&lt;-</span> <span class="fu">double</span>(<span class="at">length =</span> <span class="fu">length</span>(lambda.vals))  </span>
<span id="cb20-6"><a href="maximum-likelihood-estimation.html#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="maximum-likelihood-estimation.html#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="co"># use a loop to find the log-likelihood for each value in lambda.vals</span></span>
<span id="cb20-8"><a href="maximum-likelihood-estimation.html#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i.lambda <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(lambda.vals)) {</span>
<span id="cb20-9"><a href="maximum-likelihood-estimation.html#cb20-9" aria-hidden="true" tabindex="-1"></a>  ll.vals[i.lambda] <span class="ot">&lt;-</span> <span class="fu">horse.ll</span>(lambda.vals[i.lambda])</span>
<span id="cb20-10"><a href="maximum-likelihood-estimation.html#cb20-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Now plot the log-likelihood values vs. the values of <span class="math inline">\(\lambda\)</span>:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="maximum-likelihood-estimation.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ll.vals <span class="sc">~</span> lambda.vals, <span class="at">xlab =</span> <span class="st">&quot;lambda&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;log likelihood&quot;</span>, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span>
<span id="cb21-2"><a href="maximum-likelihood-estimation.html#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fl">0.7</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="01-LikelihoodIntro_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
<div id="find-the-mle-numerically-using-optimize" class="section level3" number="1.2.2">
<h3><span class="header-section-number">1.2.2</span> Find the MLE numerically using ‘optimize’</h3>
<p>Bolker’s book illustrates numerical optimization using the <code>optim</code> function. The R documentation recommends using <code>optimize</code> for one-dimensional optimization, and <code>optim</code> for optimizing a function in several dimensions. So, we will use <code>optimize</code> here. We will enclose the entire call to <code>optimize</code> in parentheses so that the output is dumped to the command line in addition to being stored as <code>horse.mle</code>.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="maximum-likelihood-estimation.html#cb22-1" aria-hidden="true" tabindex="-1"></a>(horse.mle <span class="ot">&lt;-</span> <span class="fu">optimize</span>(<span class="at">f =</span> horse.ll, <span class="at">interval =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">2</span>), <span class="at">maximum =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<pre><code>## $maximum
## [1] 0.7000088
## 
## $objective
## [1] -314.1545</code></pre>
<p>The <code>optimize</code> function returns a ‘list’. A list is an R object that contains components of different types. The numerically calculated MLE is <span class="math inline">\(\hat{\lambda} \approx 0.7\)</span>. The ‘objective’ component of  gives the value of the log-likelihood at that point.</p>
</div>
</div>
<div id="myxomatosis-data" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Myxomatosis data</h2>
<p>The myxomatosis data are in Bolker’s library <code>emdbook</code>. First load the library. If the library is not found, you will first have to download and install the library on your computer, using the Packages tab in RStudio. The call to <code>data</code> loads the particular myxomatosis data set that we want into memory.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="maximum-likelihood-estimation.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emdbook)</span>
<span id="cb24-2"><a href="maximum-likelihood-estimation.html#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(MyxoTiter_sum)</span></code></pre></div>
<p>Inspect the data to make sure they have been imported correctly.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="maximum-likelihood-estimation.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(MyxoTiter_sum)</span></code></pre></div>
<pre><code>##      grade            day             titer      
##  Min.   :1.000   Min.   : 2.000   Min.   :1.958  
##  1st Qu.:3.000   1st Qu.: 4.000   1st Qu.:5.400  
##  Median :4.000   Median : 8.000   Median :6.612  
##  Mean   :3.604   Mean   : 9.564   Mean   :6.331  
##  3rd Qu.:5.000   3rd Qu.:13.000   3rd Qu.:7.489  
##  Max.   :5.000   Max.   :28.000   Max.   :9.021</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="maximum-likelihood-estimation.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(MyxoTiter_sum)</span></code></pre></div>
<pre><code>##   grade day titer
## 1     1   2 5.207
## 2     1   2 5.734
## 3     1   2 6.613
## 4     1   3 5.997
## 5     1   3 6.612
## 6     1   3 6.810</code></pre>
<p>Extract the subset of the data that corresponds to the “grade 1” viral strain.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="maximum-likelihood-estimation.html#cb29-1" aria-hidden="true" tabindex="-1"></a>myxo <span class="ot">&lt;-</span> <span class="fu">subset</span>(MyxoTiter_sum, grade <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb29-2"><a href="maximum-likelihood-estimation.html#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(myxo)</span></code></pre></div>
<pre><code>##      grade        day            titer      
##  Min.   :1   Min.   :2.000   Min.   :4.196  
##  1st Qu.:1   1st Qu.:3.500   1st Qu.:6.556  
##  Median :1   Median :5.000   Median :7.112  
##  Mean   :1   Mean   :5.037   Mean   :6.924  
##  3rd Qu.:1   3rd Qu.:6.000   3rd Qu.:7.543  
##  Max.   :1   Max.   :9.000   Max.   :8.499</code></pre>
<p>Out of curiosity, let’s make a scatterplot of the titer vs. the day</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="maximum-likelihood-estimation.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(myxo, <span class="fu">plot</span>(titer <span class="sc">~</span> day))</span></code></pre></div>
<p><img src="01-LikelihoodIntro_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p>For the sake of this example, we will ignore the apparent (and unsurprising) relationship between titer and day, and instead will consider only the titer data. We will regard these data as a random sample from a normal distribution. For the sake of illustration, we will estimate the mean and variance of the normal distribution using the <code>optim</code> function in R.</p>
<p>First, we write a function to calculate the log likelihood.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="maximum-likelihood-estimation.html#cb32-1" aria-hidden="true" tabindex="-1"></a>myxo.ll <span class="ot">&lt;-</span> <span class="cf">function</span>(m, v){</span>
<span id="cb32-2"><a href="maximum-likelihood-estimation.html#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="maximum-likelihood-estimation.html#cb32-3" aria-hidden="true" tabindex="-1"></a>  ll.vals <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(myxo<span class="sc">$</span>titer, <span class="at">mean =</span> m, <span class="at">sd =</span> <span class="fu">sqrt</span>(v), <span class="at">log =</span> <span class="cn">TRUE</span>)</span>
<span id="cb32-4"><a href="maximum-likelihood-estimation.html#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(ll.vals)</span>
<span id="cb32-5"><a href="maximum-likelihood-estimation.html#cb32-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Note that R’s function for the pdf of a normal distribution — <code>dnorm</code> — is parameterized by the mean and standard deviation (SD) of the normal distribution. Although it would be just as easy to find the MLE of the standard deviation <span class="math inline">\(\sigma\)</span>, for the sake of illustration, we will seek the MLE of the variance, <span class="math inline">\(\sigma^2\)</span>. (It turns out that, if we write the MLE of the standard deviation as <span class="math inline">\(\hat{\sigma}\)</span> and the MLE of the variance as <span class="math inline">\(\hat{\sigma}^2\)</span>, then <span class="math inline">\(\hat{\sigma} = \sqrt{\hat{\sigma}^2}\)</span>. This is an example of the {} of MLEs.)</p>
<p>We can use our function to calculate the likelihood for any choice of mean and variance. For example, let’s try <span class="math inline">\(\mu = 6\)</span> and <span class="math inline">\(\sigma^2 = 1\)</span>.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="maximum-likelihood-estimation.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">myxo.ll</span>(<span class="at">m =</span> <span class="dv">6</span>, <span class="at">v =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] -47.91229</code></pre>
<p>We want to maximize the likelihood using <code>optim</code>. Unfortuantely, <code>optim</code> is a little finicky. To use <code>optim</code>, we have to re-write our function <code>myxo.ll</code> so that the parameters to be estimated are passed to the function as a single vector. Also, by default, <code>optim</code> performs minimization instead of maximization. We can change this behavior when we call <code>optim</code>. Alternatively, we can just re-define the function to return the negative log likelihood.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="maximum-likelihood-estimation.html#cb35-1" aria-hidden="true" tabindex="-1"></a>myxo.neg.ll <span class="ot">&lt;-</span> <span class="cf">function</span>(pars){</span>
<span id="cb35-2"><a href="maximum-likelihood-estimation.html#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="maximum-likelihood-estimation.html#cb35-3" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> pars[<span class="dv">1</span>]</span>
<span id="cb35-4"><a href="maximum-likelihood-estimation.html#cb35-4" aria-hidden="true" tabindex="-1"></a>  v <span class="ot">&lt;-</span> pars[<span class="dv">2</span>]</span>
<span id="cb35-5"><a href="maximum-likelihood-estimation.html#cb35-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-6"><a href="maximum-likelihood-estimation.html#cb35-6" aria-hidden="true" tabindex="-1"></a>  ll.vals <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(myxo<span class="sc">$</span>titer, <span class="at">mean =</span> m, <span class="at">sd =</span> <span class="fu">sqrt</span>(v), <span class="at">log =</span> <span class="cn">TRUE</span>)</span>
<span id="cb35-7"><a href="maximum-likelihood-estimation.html#cb35-7" aria-hidden="true" tabindex="-1"></a>  <span class="sc">-</span><span class="fu">sum</span>(ll.vals)</span>
<span id="cb35-8"><a href="maximum-likelihood-estimation.html#cb35-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Now we can use <code>optim</code>:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="maximum-likelihood-estimation.html#cb36-1" aria-hidden="true" tabindex="-1"></a>(myxo.mle <span class="ot">&lt;-</span> <span class="fu">optim</span>(<span class="at">par =</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">1</span>),  <span class="co"># starting values, just a ballpark guess </span></span>
<span id="cb36-2"><a href="maximum-likelihood-estimation.html#cb36-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fn  =</span> myxo.neg.ll))</span></code></pre></div>
<pre><code>## $par
## [1] 6.9241029 0.8571471
## 
## $value
## [1] 36.23228
## 
## $counts
## function gradient 
##       55       NA 
## 
## $convergence
## [1] 0
## 
## $message
## NULL</code></pre>
<p>Note that the MLE of the variance is
<span class="math display">\[
\hat{\sigma}^2 = \frac{\sum_i (x_i - \bar{x})}{n}.
\]</span>
Let’s verify this by calculating the same quantity at the command line:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="maximum-likelihood-estimation.html#cb38-1" aria-hidden="true" tabindex="-1"></a>residuals <span class="ot">&lt;-</span> <span class="fu">with</span>(myxo, titer <span class="sc">-</span> <span class="fu">mean</span>(titer))</span>
<span id="cb38-2"><a href="maximum-likelihood-estimation.html#cb38-2" aria-hidden="true" tabindex="-1"></a>ss <span class="ot">&lt;-</span> <span class="fu">sum</span>(residuals<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb38-3"><a href="maximum-likelihood-estimation.html#cb38-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(myxo<span class="sc">$</span>titer)</span>
<span id="cb38-4"><a href="maximum-likelihood-estimation.html#cb38-4" aria-hidden="true" tabindex="-1"></a>ss <span class="sc">/</span> n</span></code></pre></div>
<pre><code>## [1] 0.8572684</code></pre>
<p>Compare this to the answer given by <code>var</code>, and to the more usual calculation of the variance as
<span class="math display">\[
s^2 = \frac{\sum_i (x_i - \bar{x})}{n-1}.
\]</span></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="maximum-likelihood-estimation.html#cb40-1" aria-hidden="true" tabindex="-1"></a>(var.usual <span class="ot">&lt;-</span> ss <span class="sc">/</span> (n <span class="sc">-</span> <span class="dv">1</span>))</span></code></pre></div>
<pre><code>## [1] 0.8902403</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="maximum-likelihood-estimation.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(myxo<span class="sc">$</span>titer)</span></code></pre></div>
<pre><code>## [1] 0.8902403</code></pre>
<p>One main take-home of this example is that when we use maximum likelihood to estimate variances for normally distributed data, the MLE is biased low. In other words, it underestimates the true variance. When we study hierarchical models later in the semester, we will regularly find ourselves estimating variances for normally distributed effects, and will have to deal with the consequences of the fact that the MLEs of these variances are biased low.</p>
<p>For models with 2 parameters, we can visualize the likelihood surface with a contour plot. To do so, the first step is to define a lattice of values at which we want to calculate the log-likelihood. We’ll do so by defining vectors for <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma^2\)</span>:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="maximum-likelihood-estimation.html#cb44-1" aria-hidden="true" tabindex="-1"></a>m.vals <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">6</span>, <span class="at">to =</span> <span class="dv">8</span>, <span class="at">by =</span> <span class="fl">0.05</span>)</span>
<span id="cb44-2"><a href="maximum-likelihood-estimation.html#cb44-2" aria-hidden="true" tabindex="-1"></a>v.vals <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fl">0.3</span>, <span class="at">to =</span> <span class="fl">2.5</span>, <span class="at">by =</span> <span class="fl">0.05</span>)</span></code></pre></div>
<p>Here is some fancy R code that shows this lattice. Don’t worry about how this plot is created, as it isn’t critical for what follows.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="maximum-likelihood-estimation.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">rep</span>(m.vals, <span class="fu">length</span>(v.vals)), <span class="fu">rep</span>(v.vals, <span class="fu">rep</span>(<span class="fu">length</span>(m.vals), <span class="fu">length</span>(v.vals))),</span>
<span id="cb45-2"><a href="maximum-likelihood-estimation.html#cb45-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="fu">expression</span>(mu),</span>
<span id="cb45-3"><a href="maximum-likelihood-estimation.html#cb45-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="fu">expression</span>(sigma<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<p><img src="01-LikelihoodIntro_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
<p>Now we will define the matrix that will store the values of the log-likelihood for each combination of <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma^2\)</span> in the lattice shown above.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="maximum-likelihood-estimation.html#cb46-1" aria-hidden="true" tabindex="-1"></a>ll.vals <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="fu">length</span>(m.vals), <span class="at">ncol =</span> <span class="fu">length</span>(v.vals))</span></code></pre></div>
<p>Next, we will write a nested loop that cycles through the lattice points, calculates the log-likelihood for each, and stores the value of the log likelihood in the matrix <code>ll.vals</code> that we just created.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="maximum-likelihood-estimation.html#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i.m <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(m.vals)) {</span>
<span id="cb47-2"><a href="maximum-likelihood-estimation.html#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i.v <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(v.vals)) {</span>
<span id="cb47-3"><a href="maximum-likelihood-estimation.html#cb47-3" aria-hidden="true" tabindex="-1"></a>    ll.vals[i.m, i.v] <span class="ot">&lt;-</span> <span class="fu">myxo.ll</span>(<span class="at">m =</span> m.vals[i.m], <span class="at">v =</span> v.vals[i.v])</span>
<span id="cb47-4"><a href="maximum-likelihood-estimation.html#cb47-4" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb47-5"><a href="maximum-likelihood-estimation.html#cb47-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Now we will use the <code>contour</code> function to build the contour plot, and then add a red dot for the MLE.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="maximum-likelihood-estimation.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contour</span>(<span class="at">x =</span> m.vals, <span class="at">y =</span> v.vals, <span class="at">z =</span> ll.vals, <span class="at">nlevels =</span> <span class="dv">100</span>,</span>
<span id="cb48-2"><a href="maximum-likelihood-estimation.html#cb48-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="fu">expression</span>(mu), <span class="at">ylab =</span> <span class="fu">expression</span>(sigma<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb48-3"><a href="maximum-likelihood-estimation.html#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="maximum-likelihood-estimation.html#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="co"># show the MLE</span></span>
<span id="cb48-5"><a href="maximum-likelihood-estimation.html#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="at">x =</span> myxo.mle<span class="sc">$</span>par[<span class="dv">1</span>], <span class="at">y =</span> myxo.mle<span class="sc">$</span>par[<span class="dv">2</span>], <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="01-LikelihoodIntro_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
</div>
<div id="tadpole-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Tadpole data</h2>
<p>Finally, we’ll take a look at the data from the functional response experiment of Vonesh &amp; Bolker (2005), described in section 6.3.1.1 of Bolker’s book. This is another example of using likelihood to estimate parameters in a two-parameter model. This example differs from the previous two examples because we won’t assume that the data constitute a simple random sample from some known distribution like the Gaussian or Poisson distribution. Instead, we’ll build a somewhat more customized model for these data that incorporates some ecological ideas. This process of building a customized model is more typical of how one would analyze a “real” data set. We’ll start by using the <code>rm</code> command to clean up the workspace.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="maximum-likelihood-estimation.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
<p>First, we’ll read in the data and explore them in various ways.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="maximum-likelihood-estimation.html#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emdbook)</span>
<span id="cb50-2"><a href="maximum-likelihood-estimation.html#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;ReedfrogFuncresp&quot;</span>)</span>
<span id="cb50-3"><a href="maximum-likelihood-estimation.html#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="maximum-likelihood-estimation.html#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="co"># rename something shorter</span></span>
<span id="cb50-5"><a href="maximum-likelihood-estimation.html#cb50-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-6"><a href="maximum-likelihood-estimation.html#cb50-6" aria-hidden="true" tabindex="-1"></a>frog <span class="ot">&lt;-</span> ReedfrogFuncresp</span>
<span id="cb50-7"><a href="maximum-likelihood-estimation.html#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(ReedfrogFuncresp)</span>
<span id="cb50-8"><a href="maximum-likelihood-estimation.html#cb50-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-9"><a href="maximum-likelihood-estimation.html#cb50-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(frog)</span></code></pre></div>
<pre><code>##     Initial           Killed     
##  Min.   :  5.00   Min.   : 1.00  
##  1st Qu.: 13.75   1st Qu.: 5.75  
##  Median : 25.00   Median :10.00  
##  Mean   : 38.12   Mean   :13.25  
##  3rd Qu.: 56.25   3rd Qu.:18.75  
##  Max.   :100.00   Max.   :35.00</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="maximum-likelihood-estimation.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(frog)</span></code></pre></div>
<pre><code>##   Initial Killed
## 1       5      1
## 2       5      2
## 3      10      5
## 4      10      6
## 5      15     10
## 6      15      9</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="maximum-likelihood-estimation.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Killed <span class="sc">~</span> Initial, <span class="at">data =</span> frog)</span></code></pre></div>
<p><img src="01-LikelihoodIntro_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
<p>Following Bolker, we’ll assume that the number of individuals killed takes a binomial distribution, where the number of trials equals the initial tadpole density, and the probability that a tadpole is killed is given by the expression
<span class="math display">\[
p_i = \dfrac{a}{1 + a h N_i}
\]</span>
The two parameters to estimate are <span class="math inline">\(a\)</span>, which we interpret as the attack rate when the prey density is low, and <span class="math inline">\(h\)</span>, which is the handling time. We’ll first construct the negative log-likelihood function.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="maximum-likelihood-estimation.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># negative log-likelihood, for use with optim</span></span>
<span id="cb55-2"><a href="maximum-likelihood-estimation.html#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="maximum-likelihood-estimation.html#cb55-3" aria-hidden="true" tabindex="-1"></a>frog.neg.ll <span class="ot">&lt;-</span> <span class="cf">function</span>(params){</span>
<span id="cb55-4"><a href="maximum-likelihood-estimation.html#cb55-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-5"><a href="maximum-likelihood-estimation.html#cb55-5" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">&lt;-</span> params[<span class="dv">1</span>]</span>
<span id="cb55-6"><a href="maximum-likelihood-estimation.html#cb55-6" aria-hidden="true" tabindex="-1"></a>  h <span class="ot">&lt;-</span> params[<span class="dv">2</span>]</span>
<span id="cb55-7"><a href="maximum-likelihood-estimation.html#cb55-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-8"><a href="maximum-likelihood-estimation.html#cb55-8" aria-hidden="true" tabindex="-1"></a>  prob.vals <span class="ot">&lt;-</span> a <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> a <span class="sc">*</span> h <span class="sc">*</span> frog<span class="sc">$</span>Initial)</span>
<span id="cb55-9"><a href="maximum-likelihood-estimation.html#cb55-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-10"><a href="maximum-likelihood-estimation.html#cb55-10" aria-hidden="true" tabindex="-1"></a>  ll.vals <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(frog<span class="sc">$</span>Killed, <span class="at">size =</span> frog<span class="sc">$</span>Initial, <span class="at">prob =</span> prob.vals, <span class="at">log =</span> <span class="cn">TRUE</span>)</span>
<span id="cb55-11"><a href="maximum-likelihood-estimation.html#cb55-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-12"><a href="maximum-likelihood-estimation.html#cb55-12" aria-hidden="true" tabindex="-1"></a>  <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> <span class="fu">sum</span>(ll.vals)</span>
<span id="cb55-13"><a href="maximum-likelihood-estimation.html#cb55-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Now we’ll find the MLE using <code>optim</code></p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="maximum-likelihood-estimation.html#cb56-1" aria-hidden="true" tabindex="-1"></a>(frog.mle <span class="ot">&lt;-</span> <span class="fu">optim</span>(<span class="at">par =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">40</span>),</span>
<span id="cb56-2"><a href="maximum-likelihood-estimation.html#cb56-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fn  =</span> frog.neg.ll))</span></code></pre></div>
<pre><code>## Warning in dbinom(frog$Killed, size = frog$Initial, prob = prob.vals, log =
## TRUE): NaNs produced</code></pre>
<pre><code>## $par
## [1] 0.52592567 0.01660454
## 
## $value
## [1] 46.72136
## 
## $counts
## function gradient 
##       59       NA 
## 
## $convergence
## [1] 0
## 
## $message
## NULL</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="maximum-likelihood-estimation.html#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># note the warnings</span></span>
<span id="cb59-2"><a href="maximum-likelihood-estimation.html#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="maximum-likelihood-estimation.html#cb59-3" aria-hidden="true" tabindex="-1"></a>a.mle <span class="ot">&lt;-</span> frog.mle<span class="sc">$</span>par[<span class="dv">1</span>]</span>
<span id="cb59-4"><a href="maximum-likelihood-estimation.html#cb59-4" aria-hidden="true" tabindex="-1"></a>h.mle <span class="ot">&lt;-</span> frog.mle<span class="sc">$</span>par[<span class="dv">2</span>]</span></code></pre></div>
<p>We’ll plot the data and overlay a fitted line.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="maximum-likelihood-estimation.html#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add a line to our plot to show the fitted curve</span></span>
<span id="cb60-2"><a href="maximum-likelihood-estimation.html#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="maximum-likelihood-estimation.html#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Killed <span class="sc">~</span> Initial, <span class="at">data =</span> frog)</span>
<span id="cb60-4"><a href="maximum-likelihood-estimation.html#cb60-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-5"><a href="maximum-likelihood-estimation.html#cb60-5" aria-hidden="true" tabindex="-1"></a>init.values <span class="ot">&lt;-</span> <span class="fu">with</span>(frog, <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">min</span>(Initial), <span class="at">to =</span> <span class="fu">max</span>(Initial), <span class="at">length =</span> <span class="dv">100</span>))</span>
<span id="cb60-6"><a href="maximum-likelihood-estimation.html#cb60-6" aria-hidden="true" tabindex="-1"></a>pred.values <span class="ot">&lt;-</span> a.mle <span class="sc">*</span> init.values <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> a.mle <span class="sc">*</span> h.mle <span class="sc">*</span> init.values)</span>
<span id="cb60-7"><a href="maximum-likelihood-estimation.html#cb60-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-8"><a href="maximum-likelihood-estimation.html#cb60-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x =</span> init.values, <span class="at">y =</span> pred.values, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="01-LikelihoodIntro_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
<p>Finally, we’ll plot the likelihood contours.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="maximum-likelihood-estimation.html#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot negative likelihood contours</span></span>
<span id="cb61-2"><a href="maximum-likelihood-estimation.html#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="maximum-likelihood-estimation.html#cb61-3" aria-hidden="true" tabindex="-1"></a>a.vals <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fl">0.3</span>, <span class="at">to =</span> <span class="fl">0.75</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb61-4"><a href="maximum-likelihood-estimation.html#cb61-4" aria-hidden="true" tabindex="-1"></a>h.vals <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fl">0.001</span>, <span class="at">to =</span> <span class="fl">0.03</span>, <span class="at">by =</span> <span class="fl">0.001</span>)</span>
<span id="cb61-5"><a href="maximum-likelihood-estimation.html#cb61-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-6"><a href="maximum-likelihood-estimation.html#cb61-6" aria-hidden="true" tabindex="-1"></a>ll.vals <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="fu">length</span>(a.vals), <span class="at">ncol =</span> <span class="fu">length</span>(h.vals))</span>
<span id="cb61-7"><a href="maximum-likelihood-estimation.html#cb61-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-8"><a href="maximum-likelihood-estimation.html#cb61-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i.a <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(a.vals)) {</span>
<span id="cb61-9"><a href="maximum-likelihood-estimation.html#cb61-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i.h <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(h.vals)) {</span>
<span id="cb61-10"><a href="maximum-likelihood-estimation.html#cb61-10" aria-hidden="true" tabindex="-1"></a>    ll.vals[i.a, i.h] <span class="ot">&lt;-</span> <span class="fu">frog.neg.ll</span>(<span class="fu">c</span>(a.vals[i.a], h.vals[i.h]))</span>
<span id="cb61-11"><a href="maximum-likelihood-estimation.html#cb61-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb61-12"><a href="maximum-likelihood-estimation.html#cb61-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb61-13"><a href="maximum-likelihood-estimation.html#cb61-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-14"><a href="maximum-likelihood-estimation.html#cb61-14" aria-hidden="true" tabindex="-1"></a><span class="fu">contour</span>(<span class="at">x =</span> a.vals, <span class="at">y =</span> h.vals, <span class="at">z =</span> ll.vals, <span class="at">nlevels =</span> <span class="dv">100</span>,</span>
<span id="cb61-15"><a href="maximum-likelihood-estimation.html#cb61-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">&quot;a&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;h&quot;</span>)</span>
<span id="cb61-16"><a href="maximum-likelihood-estimation.html#cb61-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-17"><a href="maximum-likelihood-estimation.html#cb61-17" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="at">x =</span> a.mle, <span class="at">y =</span> h.mle, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="01-LikelihoodIntro_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
<p>Note that, in contrast to the Myxomatosis data, here the likelihood contours form regions whose major axes are not parallel to the parameter axes. We’ll reflect on the implications of this shape in the next section.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>

<a href="beyond-the-mle-confidence-regions-and-hypothesis-tests-using-the-likelihood-function.html" class="navigation navigation-next navigation-unique" aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
