<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>BMA / ST 590 Course Notes</title>
  <meta name="description" content="Course notes for BMA / ST 590, Statistical Modeling in Ecology, NCSU, Fall 2021." />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="BMA / ST 590 Course Notes" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Course notes for BMA / ST 590, Statistical Modeling in Ecology, NCSU, Fall 2021." />
  <meta name="github-repo" content="krgross/bma590-course-notes" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="BMA / ST 590 Course Notes" />
  
  <meta name="twitter:description" content="Course notes for BMA / ST 590, Statistical Modeling in Ecology, NCSU, Fall 2021." />
  

<meta name="author" content="Kevin Gross" />


<meta name="date" content="2021-08-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  

<link rel="next" href="mles-for-tadpole-predation-data.html"/>
<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="introduction-to-likelihood.html"><a href="introduction-to-likelihood.html"><i class="fa fa-check"></i><b>1</b> Introduction to likelihood</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction-to-likelihood.html"><a href="introduction-to-likelihood.html#a-likelihood-with-a-single-parameter-horse-kick-data"><i class="fa fa-check"></i><b>1.1</b> A likelihood with a single parameter: Horse-kick data</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="introduction-to-likelihood.html"><a href="introduction-to-likelihood.html#calculate-and-plot-the-log-likelihood-function"><i class="fa fa-check"></i><b>1.1.1</b> Calculate and plot the log-likelihood function</a></li>
<li class="chapter" data-level="1.1.2" data-path="introduction-to-likelihood.html"><a href="introduction-to-likelihood.html#find-the-mle-numerically-using-optimize"><i class="fa fa-check"></i><b>1.1.2</b> Find the MLE numerically using ‘optimize’</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introduction-to-likelihood.html"><a href="introduction-to-likelihood.html#myxomatosis-data"><i class="fa fa-check"></i><b>1.2</b> Myxomatosis data</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="mles-for-tadpole-predation-data.html"><a href="mles-for-tadpole-predation-data.html"><i class="fa fa-check"></i><b>2</b> MLEs for tadpole predation data</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">BMA / ST 590 Course Notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="header">
<h1 class="title">BMA / ST 590 Course Notes</h1>
<p class="author"><em>Kevin Gross</em></p>
<p class="date" style="margin-top: 1.5em;"><em>2021-08-13</em></p>
</div>
<div id="introduction-to-likelihood" class="section level1" number="1">
<h1><span class="header-section-number">Chapter 1</span> Introduction to likelihood</h1>
<div id="a-likelihood-with-a-single-parameter-horse-kick-data" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> A likelihood with a single parameter: Horse-kick data</h2>
<p>First import the data. Note that the pathname used here is specific to the file directory that was used to create this file. The pathname that you use will likely differ.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="introduction-to-likelihood.html#cb1-1" aria-hidden="true" tabindex="-1"></a>horse <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;data/horse.txt&quot;</span>, <span class="at">header =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>Ask for a <code>summary</code> of the data to make sure the data have been imported correctly.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="introduction-to-likelihood.html#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(horse)</span></code></pre></div>
<pre><code>##       year         corps               deaths   
##  Min.   :1875   Length:280         Min.   :0.0  
##  1st Qu.:1880   Class :character   1st Qu.:0.0  
##  Median :1884   Mode  :character   Median :0.0  
##  Mean   :1884                      Mean   :0.7  
##  3rd Qu.:1889                      3rd Qu.:1.0  
##  Max.   :1894                      Max.   :4.0</code></pre>
<p>We can also learn about the data by asking to see the first few records using the <code>head</code> command</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="introduction-to-likelihood.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(horse)</span></code></pre></div>
<pre><code>##   year corps deaths
## 1 1875    GC      0
## 2 1876    GC      2
## 3 1877    GC      2
## 4 1878    GC      1
## 5 1879    GC      0
## 6 1880    GC      0</code></pre>
<p>or we can see the last few records using the <code>tail</code> command:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="introduction-to-likelihood.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(horse)</span></code></pre></div>
<pre><code>##     year corps deaths
## 275 1889   C15      2
## 276 1890   C15      2
## 277 1891   C15      0
## 278 1892   C15      0
## 279 1893   C15      0
## 280 1894   C15      0</code></pre>
<p>Let’s plot a histogram of the values:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="introduction-to-likelihood.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(horse<span class="sc">$</span>deaths,</span>
<span id="cb8-2"><a href="introduction-to-likelihood.html#cb8-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">min</span>(horse<span class="sc">$</span>deaths) <span class="sc">-</span> <span class="fl">0.5</span>, </span>
<span id="cb8-3"><a href="introduction-to-likelihood.html#cb8-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">to =</span> <span class="fu">max</span>(horse<span class="sc">$</span>deaths) <span class="sc">+</span> <span class="fl">0.5</span>, </span>
<span id="cb8-4"><a href="introduction-to-likelihood.html#cb8-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">by =</span> <span class="dv">1</span>))</span></code></pre></div>
<p><img src="01-class02_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<div id="calculate-and-plot-the-log-likelihood-function" class="section level3" number="1.1.1">
<h3><span class="header-section-number">1.1.1</span> Calculate and plot the log-likelihood function</h3>
<p>Create a function that calculates the log-likelihood for a value of <span class="math inline">\(\lambda\)</span>:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="introduction-to-likelihood.html#cb9-1" aria-hidden="true" tabindex="-1"></a>horse.ll <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda){</span>
<span id="cb9-2"><a href="introduction-to-likelihood.html#cb9-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-3"><a href="introduction-to-likelihood.html#cb9-3" aria-hidden="true" tabindex="-1"></a>  ll.vals <span class="ot">&lt;-</span> <span class="fu">dpois</span>(<span class="at">x =</span> horse<span class="sc">$</span>deaths, <span class="at">lambda =</span> lambda, <span class="at">log =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-4"><a href="introduction-to-likelihood.html#cb9-4" aria-hidden="true" tabindex="-1"></a>  ll <span class="ot">&lt;-</span> <span class="fu">sum</span>(ll.vals)</span>
<span id="cb9-5"><a href="introduction-to-likelihood.html#cb9-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-6"><a href="introduction-to-likelihood.html#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(ll)</span>
<span id="cb9-7"><a href="introduction-to-likelihood.html#cb9-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>We can use this function to calculate the log-likelihood for any value of <span class="math inline">\(\lambda\)</span>, such as <span class="math inline">\(\lambda = 1\)</span>:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="introduction-to-likelihood.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">horse.ll</span>(<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] -328.2462</code></pre>
<p>Let’s calculate the log-likelihood for many values of <span class="math inline">\(\lambda\)</span>, in preparation for making a plot. We’ll use a loop here, and not worry about vectorization.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="introduction-to-likelihood.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a vector of lambda values using the &#39;seq&#39;uence command</span></span>
<span id="cb12-2"><a href="introduction-to-likelihood.html#cb12-2" aria-hidden="true" tabindex="-1"></a>lambda.vals <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fl">0.1</span>, <span class="at">to =</span> <span class="fl">2.0</span>, <span class="at">by =</span> <span class="fl">0.01</span>)  </span>
<span id="cb12-3"><a href="introduction-to-likelihood.html#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="introduction-to-likelihood.html#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># create an empty vector to store the values of the log-likelihood</span></span>
<span id="cb12-5"><a href="introduction-to-likelihood.html#cb12-5" aria-hidden="true" tabindex="-1"></a>ll.vals <span class="ot">&lt;-</span> <span class="fu">double</span>(<span class="at">length =</span> <span class="fu">length</span>(lambda.vals))  </span>
<span id="cb12-6"><a href="introduction-to-likelihood.html#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="introduction-to-likelihood.html#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># use a loop to find the log-likelihood for each value in lambda.vals</span></span>
<span id="cb12-8"><a href="introduction-to-likelihood.html#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i.lambda <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(lambda.vals)) {</span>
<span id="cb12-9"><a href="introduction-to-likelihood.html#cb12-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-10"><a href="introduction-to-likelihood.html#cb12-10" aria-hidden="true" tabindex="-1"></a>  ll.vals[i.lambda] <span class="ot">&lt;-</span> <span class="fu">horse.ll</span>(lambda.vals[i.lambda])</span>
<span id="cb12-11"><a href="introduction-to-likelihood.html#cb12-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Now plot the log-likelihood values vs. the values of <span class="math inline">\(\lambda\)</span>:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="introduction-to-likelihood.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ll.vals <span class="sc">~</span> lambda.vals, <span class="at">xlab =</span> <span class="st">&quot;lambda&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;log likelihood&quot;</span>, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span>
<span id="cb13-2"><a href="introduction-to-likelihood.html#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fl">0.7</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="01-class02_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
</div>
<div id="find-the-mle-numerically-using-optimize" class="section level3" number="1.1.2">
<h3><span class="header-section-number">1.1.2</span> Find the MLE numerically using ‘optimize’</h3>
<p>Note that Bolker’s book illustrates numerical optimization using the ‘optim’ function. The R documentation recommends using ‘optimize’ for one-dimensional optimization, and ‘optim’ for optimizing a function in several dimensions. So, we will use ‘optimize’ here.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="introduction-to-likelihood.html#cb14-1" aria-hidden="true" tabindex="-1"></a>horse.mle <span class="ot">&lt;-</span> <span class="fu">optimize</span>(<span class="at">f =</span> horse.ll, <span class="at">interval =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">2</span>), <span class="at">maximum =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>The ‘optimize’ function returns a ‘list.’ A list is an R object that contains components of different types. We can see all the components of this list by printing it.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="introduction-to-likelihood.html#cb15-1" aria-hidden="true" tabindex="-1"></a>horse.mle </span></code></pre></div>
<pre><code>## $maximum
## [1] 0.7000088
## 
## $objective
## [1] -314.1545</code></pre>
<p>So the numerically calculated MLE is <span class="math inline">\(\hat{lambda} \approx 0.7\)</span>. The ‘objective’ component of  gives the value of the log-likelihood at that point.</p>
</div>
</div>
<div id="myxomatosis-data" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Myxomatosis data</h2>
<p>The myxomatosis data are in Bolker’s library ‘emdbook.’ First load the library. If the library is not found, you will first have to download and install the library on your computer, using the Packages tab in RStudio.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="introduction-to-likelihood.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emdbook)</span>
<span id="cb17-2"><a href="introduction-to-likelihood.html#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(MyxoTiter_sum)</span></code></pre></div>
<p>Inspect the data to make sure they have been imported correctly.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="introduction-to-likelihood.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(MyxoTiter_sum)</span></code></pre></div>
<pre><code>##      grade            day             titer      
##  Min.   :1.000   Min.   : 2.000   Min.   :1.958  
##  1st Qu.:3.000   1st Qu.: 4.000   1st Qu.:5.400  
##  Median :4.000   Median : 8.000   Median :6.612  
##  Mean   :3.604   Mean   : 9.564   Mean   :6.331  
##  3rd Qu.:5.000   3rd Qu.:13.000   3rd Qu.:7.489  
##  Max.   :5.000   Max.   :28.000   Max.   :9.021</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="introduction-to-likelihood.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(MyxoTiter_sum)</span></code></pre></div>
<pre><code>##   grade day titer
## 1     1   2 5.207
## 2     1   2 5.734
## 3     1   2 6.613
## 4     1   3 5.997
## 5     1   3 6.612
## 6     1   3 6.810</code></pre>
<p>Extract the subset of the data that corresponds to the ``grade 1’’ viral strain.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="introduction-to-likelihood.html#cb22-1" aria-hidden="true" tabindex="-1"></a>myxo <span class="ot">&lt;-</span> <span class="fu">subset</span>(MyxoTiter_sum, grade <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb22-2"><a href="introduction-to-likelihood.html#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(myxo)</span></code></pre></div>
<pre><code>##      grade        day            titer      
##  Min.   :1   Min.   :2.000   Min.   :4.196  
##  1st Qu.:1   1st Qu.:3.500   1st Qu.:6.556  
##  Median :1   Median :5.000   Median :7.112  
##  Mean   :1   Mean   :5.037   Mean   :6.924  
##  3rd Qu.:1   3rd Qu.:6.000   3rd Qu.:7.543  
##  Max.   :1   Max.   :9.000   Max.   :8.499</code></pre>
<p>Out of curiosity, let’s make a scatterplot of the titer vs. the day</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="introduction-to-likelihood.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(myxo, <span class="fu">plot</span>(titer <span class="sc">~</span> day))</span></code></pre></div>
<p><img src="01-class02_files/figure-html/unnamed-chunk-15-1.png" width="672" />
For the sake of this example, we will ignore the apparent (and unsurprising) relationship between titer and day, and instead will consider only the titer data. We will regard these data as a random sample from a normal distribution. For the sake of illustration, we will estimate the mean and variance of the normal distribution using the  function in R.</p>
<p>First, we write a function to calculate the log likelihood.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="introduction-to-likelihood.html#cb25-1" aria-hidden="true" tabindex="-1"></a>myxo.ll <span class="ot">&lt;-</span> <span class="cf">function</span>(m, v){</span>
<span id="cb25-2"><a href="introduction-to-likelihood.html#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="introduction-to-likelihood.html#cb25-3" aria-hidden="true" tabindex="-1"></a>  ll.vals <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(myxo<span class="sc">$</span>titer, <span class="at">mean =</span> m, <span class="at">sd =</span> <span class="fu">sqrt</span>(v), <span class="at">log =</span> <span class="cn">TRUE</span>)</span>
<span id="cb25-4"><a href="introduction-to-likelihood.html#cb25-4" aria-hidden="true" tabindex="-1"></a>  ll <span class="ot">&lt;-</span> <span class="fu">sum</span>(ll.vals)</span>
<span id="cb25-5"><a href="introduction-to-likelihood.html#cb25-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-6"><a href="introduction-to-likelihood.html#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(ll)</span>
<span id="cb25-7"><a href="introduction-to-likelihood.html#cb25-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Note that R’s function for the pdf of a normal distribution —  — is parameterized by the mean and standard deviation (SD) of the normal distribution. Although it would be just as easy to find the MLE of the standard deviation <span class="math inline">\(\sigma\)</span>, for the sake of illustration, we will seek the MLE of the variance, <span class="math inline">\(\sigma^2\)</span>.</p>
<p>We can use our function to calculate the likelihood for any choice of mean and variance. For example, let’s try <span class="math inline">\(\mu = 6\)</span> and <span class="math inline">\(\sigma^2 = 1\)</span>.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="introduction-to-likelihood.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">myxo.ll</span>(<span class="at">m =</span> <span class="dv">6</span>, <span class="at">v =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] -47.91229</code></pre>
<p>We want to maximize the likelihood using . Unfortuantely,  is a little finicky. To use , we have to re-write our function  so that the parameters to be estimated are passed to the function as a single vector. Also, by default,  performs minimization instead of maximization. We can change this behavior when we call . Alternatively, we can just re-define the function to return the negative log likelihood.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="introduction-to-likelihood.html#cb28-1" aria-hidden="true" tabindex="-1"></a>myxo.neg.ll <span class="ot">&lt;-</span> <span class="cf">function</span>(pars){</span>
<span id="cb28-2"><a href="introduction-to-likelihood.html#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="introduction-to-likelihood.html#cb28-3" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> pars[<span class="dv">1</span>]</span>
<span id="cb28-4"><a href="introduction-to-likelihood.html#cb28-4" aria-hidden="true" tabindex="-1"></a>  v <span class="ot">&lt;-</span> pars[<span class="dv">2</span>]</span>
<span id="cb28-5"><a href="introduction-to-likelihood.html#cb28-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-6"><a href="introduction-to-likelihood.html#cb28-6" aria-hidden="true" tabindex="-1"></a>  ll.vals <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(myxo<span class="sc">$</span>titer, <span class="at">mean =</span> m, <span class="at">sd =</span> <span class="fu">sqrt</span>(v), <span class="at">log =</span> <span class="cn">TRUE</span>)</span>
<span id="cb28-7"><a href="introduction-to-likelihood.html#cb28-7" aria-hidden="true" tabindex="-1"></a>  ll <span class="ot">&lt;-</span> <span class="fu">sum</span>(ll.vals)</span>
<span id="cb28-8"><a href="introduction-to-likelihood.html#cb28-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-9"><a href="introduction-to-likelihood.html#cb28-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="sc">-</span>ll)</span>
<span id="cb28-10"><a href="introduction-to-likelihood.html#cb28-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Now we can use :</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="introduction-to-likelihood.html#cb29-1" aria-hidden="true" tabindex="-1"></a>myxo.mle <span class="ot">&lt;-</span> <span class="fu">optim</span>(<span class="at">par =</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">1</span>),  <span class="co"># starting values, just a ballpark guess </span></span>
<span id="cb29-2"><a href="introduction-to-likelihood.html#cb29-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fn  =</span> myxo.neg.ll)</span>
<span id="cb29-3"><a href="introduction-to-likelihood.html#cb29-3" aria-hidden="true" tabindex="-1"></a>myxo.mle</span></code></pre></div>
<pre><code>## $par
## [1] 6.9241029 0.8571471
## 
## $value
## [1] 36.23228
## 
## $counts
## function gradient 
##       55       NA 
## 
## $convergence
## [1] 0
## 
## $message
## NULL</code></pre>
<p>Note that the MLE of the variance is
<span class="math display">\[
\hat{\sigma}^2 = \frac{\sum_i (x_i - \bar{x})}{n}.
\]</span>
Let’s verify this by calculating the same quantity at the command line:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="introduction-to-likelihood.html#cb31-1" aria-hidden="true" tabindex="-1"></a>residuals <span class="ot">&lt;-</span> <span class="fu">with</span>(myxo, titer <span class="sc">-</span> <span class="fu">mean</span>(titer))</span>
<span id="cb31-2"><a href="introduction-to-likelihood.html#cb31-2" aria-hidden="true" tabindex="-1"></a>ss <span class="ot">&lt;-</span> <span class="fu">sum</span>(residuals<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb31-3"><a href="introduction-to-likelihood.html#cb31-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(myxo<span class="sc">$</span>titer)</span>
<span id="cb31-4"><a href="introduction-to-likelihood.html#cb31-4" aria-hidden="true" tabindex="-1"></a>var.mle <span class="ot">&lt;-</span> ss <span class="sc">/</span> n</span>
<span id="cb31-5"><a href="introduction-to-likelihood.html#cb31-5" aria-hidden="true" tabindex="-1"></a>var.mle</span></code></pre></div>
<pre><code>## [1] 0.8572684</code></pre>
<p>Compare this to the answer given by , and to the more usual calculation of</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="introduction-to-likelihood.html#cb33-1" aria-hidden="true" tabindex="-1"></a>var.usual <span class="ot">&lt;-</span> ss <span class="sc">/</span> (n <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb33-2"><a href="introduction-to-likelihood.html#cb33-2" aria-hidden="true" tabindex="-1"></a>var.usual</span></code></pre></div>
<pre><code>## [1] 0.8902403</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="introduction-to-likelihood.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(myxo<span class="sc">$</span>titer)</span></code></pre></div>
<pre><code>## [1] 0.8902403</code></pre>
<p>Make a contour plot of the likelihood surface.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="introduction-to-likelihood.html#cb37-1" aria-hidden="true" tabindex="-1"></a>m.vals <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">6</span>, <span class="at">to =</span> <span class="dv">8</span>, <span class="at">by =</span> <span class="fl">0.05</span>)</span>
<span id="cb37-2"><a href="introduction-to-likelihood.html#cb37-2" aria-hidden="true" tabindex="-1"></a>v.vals <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fl">0.3</span>, <span class="at">to =</span> <span class="fl">2.5</span>, <span class="at">by =</span> <span class="fl">0.05</span>)</span>
<span id="cb37-3"><a href="introduction-to-likelihood.html#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="introduction-to-likelihood.html#cb37-4" aria-hidden="true" tabindex="-1"></a>ll.vals <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="fu">length</span>(m.vals), <span class="at">ncol =</span> <span class="fu">length</span>(v.vals))</span>
<span id="cb37-5"><a href="introduction-to-likelihood.html#cb37-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-6"><a href="introduction-to-likelihood.html#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i.m <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(m.vals)) {</span>
<span id="cb37-7"><a href="introduction-to-likelihood.html#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i.v <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(v.vals)) {</span>
<span id="cb37-8"><a href="introduction-to-likelihood.html#cb37-8" aria-hidden="true" tabindex="-1"></a>    ll.vals[i.m, i.v] <span class="ot">&lt;-</span> <span class="fu">myxo.ll</span>(<span class="at">m =</span> m.vals[i.m], <span class="at">v =</span> v.vals[i.v])</span>
<span id="cb37-9"><a href="introduction-to-likelihood.html#cb37-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb37-10"><a href="introduction-to-likelihood.html#cb37-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-11"><a href="introduction-to-likelihood.html#cb37-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-12"><a href="introduction-to-likelihood.html#cb37-12" aria-hidden="true" tabindex="-1"></a><span class="fu">contour</span>(<span class="at">x =</span> m.vals, <span class="at">y =</span> v.vals, <span class="at">z =</span> ll.vals, <span class="at">nlevels =</span> <span class="dv">100</span>,</span>
<span id="cb37-13"><a href="introduction-to-likelihood.html#cb37-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">&quot;mean&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;variance&quot;</span>)</span>
<span id="cb37-14"><a href="introduction-to-likelihood.html#cb37-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-15"><a href="introduction-to-likelihood.html#cb37-15" aria-hidden="true" tabindex="-1"></a><span class="co"># show the MLE</span></span>
<span id="cb37-16"><a href="introduction-to-likelihood.html#cb37-16" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="at">x =</span> myxo.mle<span class="sc">$</span>par[<span class="dv">1</span>], <span class="at">y =</span> myxo.mle<span class="sc">$</span>par[<span class="dv">2</span>], <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="01-class02_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>

<a href="mles-for-tadpole-predation-data.html" class="navigation navigation-next navigation-unique" aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
